这里是第三章的电机控制模块，单片机通过串口总线实时接收目标位置（该目标位置不是空间坐标系，而是已经逆解完成之后的电机实际需要转动的角度），并输出脉冲和方向信号，以控制电机快速到达目标位置。

该程序的目的是：在不违反最大速度和加速度等条件的情况下，快速到达目标位置。


20230330-阿能于南京C楼302房间，在边嗑瓜子边刷抖音的情况下，开启了一个B7引脚作为外部上升沿中断输入。用于记录B6引脚PWM输出的脉冲数量.

使用PWM和查表法，做了加减速的输出程序，具体加减速要生成一张速度列表。输出引脚为定时器的PWM
也可以使用外部计算法，可以省去很多ram空间。

与外部通讯协议
波特率115200
数据包长度固定为15个字节

0：起始码 0xcc
1：设备地址码 1-250，0为所有地址。255，上位机
2：操作码	 0x03为读取寄存器，0X06为写入寄存器。
3-4：内存地址码，占用两个字节。用于需要操作的设备寄存器地址
5-12：数据，数据长度统一8个字节
13-14：CRC校验

寄存器说明：
地址0： 定时器最大频率，默认32000000，不需要改变。
地址1：输出脉冲的最小频率，默认500步每秒，不需要改变。如果太小会导致定时器溢出。
地址2：输出脉冲的最大频率，默认32K步每秒，F4的芯片一般不得大于96K，否则计数器来不及导致脉冲数量错误。
地址3：电机加速度，默认64K步每秒，太大导致电机跟步上，ram太小导致达不到所需的速度。（如果使用主循环速度计算器无需考虑ram太小的问题
地址4：电机绝对位置，向该地址写入数据，电机会达到该指定位置
地址5：写入位置之后是否立即启动电机，0立即启动。1等待该位置2时启动。当该位为1时，写入地址4之后电机不会启动，要再向此位置写入2才会启动，然后该位会自动置1。
地址6：当写入地址4或者5之后，是否返回数据，0表示返回，1表示不返回
地址7：写入1让电机立即停止


只读寄存器
256+0:当前位置电机实际位置
256+1:当前电机的实际速度
256+2:立刻刹车所停止的位置
256+3：定时CNT
256+4：速度控制器，加速，减速，或者匀速
256+5：外部中断记录的脉冲位置

20230330-加入一路外部中断输入，用于确认发出的脉冲数量是不是正确的（对比部分没写，目前只是记录）
20230401-在南京c楼302房间，喝着可口可乐，通讯部分完成，具体寄存器看以上说明
数据断电不会保存，会恢复默认设置。举例希望电机转动到100步的位置就向串口输出[0xcc,0x01,0x06,0x00,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x64,0xc3,0x46]

